---
---

<!DOCTYPE html>
<html lang="en">

<head>
    <title>WhatsApp Unsaved Numbers</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="Start a WhatsApp chat with people not in your contacts list">

    <link rel="preconnect" href="https://unpkg.com">
    <link rel="preconnect" href="https://ipapi.co">
    <link rel="preconnect" href="https://api.WhatsApp.com">

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">

    <script src="https://unpkg.com/libphonenumber-js@1.7.25/bundle/libphonenumber-mobile.js"></script>

    <link rel="manifest" href="{{ site.baseurl }}/manifest.json">
    <meta name="theme-color" content="#1ebea5">


    <!-- Add to homescreen for Chrome on Android. Fallback for manifest.json -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="application-name" content="WhatsApp Unsaved Numbers">

    <!-- Add to homescreen for Safari on iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="WhatsApp Unsaved Numbers">
    <link rel="apple-touch-icon" href="apple-touch-icon.png">
    
    <style type="text/css">
        html,body {
            height: 100%;
        }

        .btn-whatsapp{
            background-color: #1ebea5;
            border-color: #1ebea5;            
        }
        .btn-whatsapp:not(:disabled):not(.disabled):active{
            background-color: #168a78;
            border-color: #168a78;             
        }
        .btn-whatsapp:not(:disabled):not(.disabled):hover{
            background-color: #168a78;
            border-color: #168a78;             
        }
    </style>

    <script type="text/javascript">
        if (document.location.hostname.search("sahilgupta.github.io") !== -1) {
            window.heap=window.heap||[],heap.load=function(e,t){window.heap.appid=e,window.heap.config=t=t||{};var r=t.forceSSL||"https:"===document.location.protocol,a=document.createElement("script");a.type="text/javascript",a.async=!0,a.src=(r?"https:":"http:")+"//cdn.heapanalytics.com/js/heap-"+e+".js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(a,n);for(var o=function(e){return function(){heap.push([e].concat(Array.prototype.slice.call(arguments,0)))}},p=["addEventProperties","addUserProperties","clearEventProperties","identify","resetIdentity","removeEventProperty","setEventProperties","track","unsetEventProperty"],c=0;c<p.length;c++)heap[p[c]]=o(p[c])};
              heap.load("1031989618");
        } else {
            window.heap=window.heap||[],heap.load=function(e,t){window.heap.appid=e,window.heap.config=t=t||{};var r=t.forceSSL||"https:"===document.location.protocol,a=document.createElement("script");a.type="text/javascript",a.async=!0,a.src=(r?"https:":"http:")+"//cdn.heapanalytics.com/js/heap-"+e+".js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(a,n);for(var o=function(e){return function(){heap.push([e].concat(Array.prototype.slice.call(arguments,0)))}},p=["addEventProperties","addUserProperties","clearEventProperties","identify","resetIdentity","removeEventProperty","setEventProperties","track","unsetEventProperty"],c=0;c<p.length;c++)heap[p[c]]=o(p[c])};
            heap.load("841248980");
        }
    </script>

    <script type="text/javascript">
        /// Get the country code corresponding to user's country
        var ipInfoAPI = 'https://ipapi.co/json/';
        var countryCode = "IN";

        var xhr = new XMLHttpRequest();
        xhr.onreadystatechange = function() {
            if (this.readyState == 4 && this.status == 200) {
                var response = JSON.parse(this.responseText);
                console.log('countryCode found: ' + response.country);
                countryCode = response.country;
            }
        };
        xhr.open('GET', ipInfoAPI, true);
        xhr.send();

        function validateNumber(inputNumber){
            var parsedNumber = libphonenumber.parsePhoneNumberFromString(inputNumber, countryCode)
            if (parsedNumber && parsedNumber.isValid() === true) {
                return parsedNumber;
            } else {
                return null;
            }
        }
        
        function prettifyVisibleNumber(parsedNumber){
            document.getElementById("visiblePhoneNumber").value = parsedNumber.formatInternational();
        }

        function submitHiddenForm(parsedNumber){
            // Remove the "+" from the E.164 formatted number to make this 
            // play well with Android 
            var phone = parsedNumber.number.substring(1);
            document.getElementById("hiddenPhoneNumber").value = phone;
            document.forms.hiddenForm.submit();
        }

        function startChat(event){
            event.preventDefault();
            var inputNumber = document.getElementById("visiblePhoneNumber").value;
            var parsedNumber = validateNumber(inputNumber);
            if (parsedNumber){
                prettifyVisibleNumber(parsedNumber);
                submitHiddenForm(parsedNumber);
            }
        }

    </script>
    <script>
        // This is the service worker with the Cache-first network
        if ("serviceWorker" in navigator) {
                  if (navigator.serviceWorker.controller) {
                    console.log("[PWA Builder] active service worker found, no need to register");
                  } else {
                    // Register the service worker
                    navigator.serviceWorker
                      .register("service-worker.js", {
                        scope: "{{ site.baseurl }}/"
                      })
                      .then(function (reg) {
                        console.log("[PWA Builder] Service worker has been registered for scope: " + reg.scope);
                      });
                  }
                }
    </script>
</head>

<body>
    <div class="container-fluid h-100">
        <div class="row h-100">
            <div class="col-12 align-self-center">
                <div class="card">
                    <div class="card-body">
                        <div class="pb-5">
                            WhatsApp people not in your contact list
                        </div>
                    
                        <form id="hiddenForm" action="https://api.WhatsApp.com/send" method="get">
                            <input type="tel" id="hiddenPhoneNumber" name="phone" hidden="true">
                        </form>

                        <form onsubmit="startChat(event);">
                            <div class="form-group">
                                <label for="visiblePhoneNumber">Phone Number</label>
                                <input type="tel" class="form-control" id="visiblePhoneNumber" required>
                            </div>
                            <button type="submit" class="btn btn-primary btn-lg btn-block btn-whatsapp">Chat on WhatsApp</button>
                        </form>

                        <div class="pt-5">
                        </div>
                        <div class="pt-5">
                        </div>
                        <div class="pt-5" id="addToHome" style="display:none">
                            <button type="button" class="btn btn-outline-info">Add to Home Screen</button>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</body>

<script type="text/javascript">
            /**
         * Determine the mobile operating system.
         * From: https://stackoverflow.com/a/21742107
         * This function returns one of 'iOS', 'Android', 'Windows Phone', or 'unknown'.
         *
         * @returns {String}
         */
        function getMobileOperatingSystem() {
          var userAgent = navigator.userAgent || navigator.vendor || window.opera;

            // Windows Phone must come first because its UA also contains "Android"
            if (/windows phone/i.test(userAgent)) {
                return "Windows Phone";
            } else if (/android/i.test(userAgent)) {
                return "Android";
            }
            // iOS detection from: http://stackoverflow.com/a/9039885/177710
            else if (/iPad|iPhone|iPod/.test(userAgent) && !window.MSStream) {
                return "iOS";
            }
            return "unknown";
        }

        var message;
        if (getMobileOperatingSystem() === "Android"){
            message = "addToHome"
        } else if(getMobileOperatingSystem() === "iOS"){
            message = "To save this on your home screen, go to Share -> Add to Home Screen"
        } else{
            message = "To save this on your home screen, go to Share -> Add to Home Screen"
        }

        let deferredPrompt;
        const addBtn = document.getElementById('addToHome');
        // addBtn.style.display = 'none';
        
        window.addEventListener('beforeinstallprompt', (e) => {
            // Prevent Chrome 67 and earlier from automatically showing the prompt
            e.preventDefault();
            // Stash the event so it can be triggered later.
            deferredPrompt = e;
            // Update UI to notify the user they can add to home screen
            addBtn.style.display = 'block';

            addBtn.addEventListener('click', (e) => {
                // hide our user interface that shows our A2HS button
                addBtn.style.display = 'none';
                // Show the prompt
                deferredPrompt.prompt();
                // Wait for the user to respond to the prompt
                deferredPrompt.userChoice.then((choiceResult) => {
                    if (choiceResult.outcome === 'accepted') {
                      console.log('User accepted the A2HS prompt');
                    } else {
                      console.log('User dismissed the A2HS prompt');
                    }
                    deferredPrompt = null;
                });
        });
        });

</script>
</html>
